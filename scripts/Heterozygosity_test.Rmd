---
title: "Heterozygosity_test"
author: "Grace Saville"
date: "01/02/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Preamble 

```{r libraries, eval = FALSE}
library(stringr)
library(dplyr)
getwd()
setwd("C:/Users/airhe/OneDrive/Documents/Masters/Project 3/kiore-project")
```

## Dataset loading
```{r eval = FALSE}
foo <- read.csv("./data/ratsSNPs_halfclean.csv") # loading the data table 
colnames(foo)
foo <- foo[,-c(2:16)] # removing unnecessary columns for this analysis
```

## Heterozygosity experimenting
```{r eval = FALSE}
dim(foo) # 379 rows 283 columns
count(unlist(foo[,17:283])) # checking what SNP combinations are present
het <- c("A:C", "A:G", "A:T", "C:G", "C:T", "T:G") # vector of heterozygous combinations
hom <- c("G:G", "A:A", "C:C", "T:T") # vector of homozygous combinations

# Replacing specific 
z <- foo # making a copy of the data
for (i in 1:nrow(z)){
  z[i,][z[i,] %in% het] <- "E" 
  z[i,][z[i,] %in% hom] <- "O"
}

str(z)

# count(z[,105]) #column count
sum(str_count(z[2,], "O")) # row count

# 0 for homo and 1 for hetero, therefore the lower the totals the lower the heterozygousity, however the number of NA's could interfere with the totals

z[z=="?"] <- NA # replacing ? with NA's 
# for (i in 17:283) {class(z[,i]) <- "integer"} # changed the class to numeric for each column so the totals can be computed (wouldn't work without for loop for some reason, could try with apply())

o.freq <- vector()
e.freq <- vector()
na.freq <- vector()
for (i in 1:379) {
  x <- sum(grepl("O", z[i,], fixed = TRUE)) # counting row O's
  o.freq <- append(o.freq, x) # adding sum to vector
  x <- sum(grepl("E", z[i,], fixed = TRUE)) # counting row E's
  e.freq <- append(e.freq, x)
  x <- sum(is.na(z[i,])) # counting row NA's
  na.freq <- append(na.freq, x)
  rm(x)
}

df <- data.frame(foo$island, o.freq, e.freq, na.freq)


# str_count(z[2,2:283], pattern = "1")

# z <- rowwise(z2) # making the df rowwise so I can make calculations by row easier
# names(z)
# z <- mutate(z, total = sum(c_across(X11_CHR1_101004452:X154_CHR9_95290356), na.rm = TRUE))
# z[,333]


```

